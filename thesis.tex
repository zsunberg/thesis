\documentclass[12pt]{report}
% note that the documentclass can take other option such as
% twoside - for double sided printing
% openright - if double side  chapters always start on odd pages
% openany - if double side chapters start on the next page even or odd
% 12pt can be replaced by 11pt

\usepackage[online]{suthesis-2e}
% options are
% online - now the default
% hardcopy - turns off online includes signature page and copyright page in file 
% engineer - does an engineer thesis instead of a PhD dissertation

%% load other packages you need
\usepackage[hidelinks]{hyperref}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[capitalize]{cleveref}
\usepackage{amsthm}
\usepackage{thmtools}
\usepackage{thm-restate}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[per-mode=symbol]{siunitx}
\usepackage{booktabs}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{tabularx}
\usepackage{rotating}
\usepackage{todonotes}
\usepackage{standalone}
\usepackage{pgfplots}
\usepackage{listings}
\usepackage{float}

\renewcommand\algorithmicthen{}
\renewcommand\algorithmicdo{}

\pgfplotsset{every axis/.append style={font=\footnotesize,legend cell align=left}}

\usepackage[natbib,
            bibstyle=ieee,
            maxnames=6,
            sorting=nyt,
            doi=false,
            backref=true,
            isbn=false
           ]{biblatex}

\AtEveryBibitem{
	\ifentrytype{inproceedings}{
		\clearfield{url}  
		\clearfield{doi}  
	}{}
}


\addbibresource{ref.bib}
\addbibresource{behavior_ref.bib}
\addbibresource{asl_main.bib}
\addbibresource{new.bib}

\sisetup{group-separator={,}}

%% uncomment the following and create mythesis-macros.sty for all your
%% own macros.  This keeps this top level file looking fairly neat.
% \usepackage{mythesis-macros}
\newcommand{\intrid}{\mathrm{i}}
\newcommand{\ownid}{\mathrm{o}}
\newcommand{\intr}[1]{\ensuremath{#1^{(\intrid)}}}
\newcommand{\own}[1]{\ensuremath{#1^{(\ownid)}}} 
\newcommand{\either}[1]{\ensuremath{#1^{(\cdot)}}}
\newcommand{\is}{\ensuremath{\intr{s}}}
\newcommand{\rs}{\ensuremath{\own{s}}}
\newcommand{\psires}{\ensuremath{\own{\psi}_\mathrm{resolution}}}
\newcommand{\psigoal}{\own{\psi}_\mathrm{goal}}
\newcommand{\sterm}{\ensuremath{s_{\mathrm{term}}}}
\newcommand{\tmin}{\ensuremath{t_{\min}}}
\newcommand{\psicand}{\own{\psi}_{\mathrm{cand}}}
\newcommand{\dgoal}{\ensuremath{D_\mathrm{goal}}}
\newcommand{\dnmac}{\ensuremath{D_\mathrm{NMAC}}}
\newcommand{\dev}{\ensuremath{\mathrm{dev }}}
% \newcommand{\argmax}[1]{\underset{#1}{\operatornamewithlimits{argmax}}}
% \newcommand{\argmin}[1]{\underset{#1}{\operatornamewithlimits{argmin}}}
\newcommand{\real}{{\mathbb{R}}}
\renewcommand{\natural}{{\mathbb{N}}}
\newcommand{\naturals}{\natural}
\newcommand{\Beta}{B}

\newcommand{\beh}{\theta}
\newcommand{\Beh}{\Theta}
\newcommand{\phys}{\ensuremath{q}}
\newcommand{\dt}{\ensuremath{\Delta t}}
\newcommand{\bmax}{\ensuremath{b_\text{max}}}
\newcommand{\ith}[1]{{#1}_i}
\newcommand{\jth}[1]{{#1}_j}
\newcommand{\ego}[1]{{#1}_e}
\newcommand{\av}{ego} % used when referring to the ego vehicle in the text

\newcommand{\diro}[1]{{#1}_\phi}
\newcommand{\tdo}[1]{{#1}_{T\phi}}
\newcommand{\trl}[1]{{#1}_{D}}

% approximately proportional to
\newcommand{\appropto}{\mathrel{\vcenter{
  \offinterlineskip\halign{\hfil$##$\cr
    \propto\cr\noalign{\kern2pt}\sim\cr\noalign{\kern-2pt}}}}}



\newcommand{\argmax}{\operatornamewithlimits{argmax}}
\newcommand{\argmin}{\operatornamewithlimits{argmin}}
\newcommand{\reals}{\ensuremath{\mathbb{R}}}
\newcommand{\sspace}{\ensuremath{\mathcal{S}}}
\newcommand{\aspace}{\ensuremath{\mathcal{A}}}
\newcommand{\ospace}{\ensuremath{\mathcal{O}}}
\newcommand{\tdist}{\ensuremath{\mathcal{T}}}
\newcommand{\odist}{\ensuremath{\mathcal{Z}}}
\newcommand{\reward}{\ensuremath{\mathcal{R}}}

\newcommand{\code}[1]{{\small\ttfamily #1}}



\newcommand{\result}[4]{% args mean, sem, color, len
    $#1\pm#2$ & {\color{green!#3!red}\rule{#4cm}{8pt}}
}
\newcommand{\noresult}{ & }


\declaretheorem[name=Theorem]{theorem}
\declaretheorem[name=Definition]{definition}
\declaretheorem[name=Lemma]{lemma}
\declaretheorem[name=Remark]{remark}

\lstdefinelanguage{Julia}%
{
  keywordsprefix=\@,
  morekeywords={abstract,break,case,catch,const,continue,do,else,elseif,%
    end,export,false,for,function,immutable,import,importall,if,in,%
    macro,module,otherwise,quote,return,switch,true,try,type,typealias,%
      using,while,struct},
     keywordstyle=\bfseries\color{red!55!black},
     classoffset=1,
     morekeywords={Float64, Int64, Bool, Any},
      keywordstyle={\bfseries\color{NavyBlue!75!black}},
      classoffset=0,
   sensitive=true,%
   alsoother={$},%$
   morecomment=[l]\#,%
   morecomment=[n]{\#=}{=\#},%
   morestring=[s]{"}{"},%
   morestring=[m]{'}{'},%
}[keywords,comments,strings]%


\lstset{%
    language         = Julia,
    basicstyle       = \ttfamily,
    keywordstyle     = \bfseries\color{blue},
    stringstyle      = \color{magenta},
    commentstyle     = \bfseries\color{OliveGreen},
    showstringspaces = false,
    gobble=0,
}

\lstdefinestyle{customjulia}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  % frame=L,
  xleftmargin=\parindent,
  language=Julia,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  commentstyle=\itshape\color{OliveGreen!90!black},
  identifierstyle=\color{black},
  stringstyle=\color{orange},
}

\lstdefinestyle{customasm}{
  belowcaptionskip=1\baselineskip,
  frame=L,
  xleftmargin=\parindent,
  language=[x86masm]Assembler,
  basicstyle=\footnotesize\ttfamily,
  commentstyle=\itshape\color{purple!40!black},
}

\newfloat{lstfloat}{htbp}{lop}
\floatname{lstfloat}{Listing}
\def\lstfloatautorefname{Listing} % needed for hyperref/auroref

\title{Safety and Efficiency in Autonomous Vehicles through Planning with Uncertainty}
\author{Zachary Nolan Sunberg}
\dept{Aeronautics and Astronautics} % default is Computer Science, uncomment for other departments
\principaladviser{Mykel J. Kochenderfer}
% \coprincipaladvisor{}
\firstreader{Marco Pavone}
\secondreader{Mac Schwager}
% \thirdreader{}

%the following command would (if uncommented) allow  only chapter1 and
%chapter2 to be processed
% \includeonly{pomcpow}

% if you feel real savvy use
% \typein{Now put in includeonly}
% the \typein command stops latex at this point and allows you to type
% in a command such as
% \includeonly{chapter3,chapter5}
% this can save some time and means you don't have to edit this file
% as much.


\begin{document}

\beforepreface 

\prefacesection{Abstract}

To be effective, autonomous air and ground vehicles should maintain safety while accomplishing tasks efficiently in terms of time and other resources.
Unfortunately, the objectives of safety and efficiency are fundamentally opposed because safety precautions prohibit some efficient actions.
Moreover, the presence of uncertainty about the environment makes planning safe and efficient actions more difficult.

The Markov decision process (MDP) is a systematic framework for modelling sequential decision problems with outcome uncertainty, and the partially observable Markov decision process (POMDP) adds the additional ability to model state uncertainty.
MDPs and POMDPs are suitable models for a wide range of situations that an autonomous vehicle might face.
However, obtaining the exact solution to a general POMDP is an intractable problem.
This thesis considers approximate MDP and POMDP solutions and seeks to quantify their utility for autonomous vehicles.
Specifically, it contains four contributions.

First, the thesis analyzes the use of a certifiable safety constraint alongside approximate optimization in the context of unmanned aerial vehicle collision avoidance.
In order to ensure safety, aerospace systems have particularly stringent certification requirements that likely preclude approximate randomized planning techniques capable of handling uncertainty.
This work evaluates the performance price that comes with using a simple certified policy and shows that MDP and POMDP optimization can significantly reduce that price and improve both safety and efficiency simultaneously.

The second application chapter considers the effects of modeling uncertainty in a difficult lane changing task for a self-driving car.
Specifically, the research estimates the value of planning with the internal states of other human drivers such as their intentions and dispositions.
While several other researchers have used internal-state-aware planning methods to interact with human drivers in desirable ways, they have not evaluated whether these methods offer a substantial quantitative improvement in performance over conventional approaches.
This thesis shows that, in a simplified simulated setting, planning with internal states using a POMDP formulation can significantly improve both safety and efficiency simultaneously.
Moreover, the thesis describes an experimental method for investigating other cases in which internal-state-aware planning may improve performance.

The benefits of POMDP planning can only be realized with algorithms that can handle real-world domains that are continuous and irregular.
To that end, the third contribution of the thesis is a pair of new algorithms for solving POMDPs with continuous state, action, and observation spaces.
These algorithms are motivated by analysis and numerical experiments that show that leading online POMDP solvers fail on continuous observation spaces because of the following two problems.
First, the large observation space causes policy trees to become too wide and not deep enough.
Second, the number of state particles used to represent beliefs collapses to one, causing overconfidence.
The new algorithms, POMCPOW and PFT-DPW, handle these problems using progressive widening and weighted particle belief representations.
Numerical experiments show that they are able to solve problems where previous methods fail.

The final contribution is a software package, POMDPs.jl, which uses the features of the Julia programming language to bring state-of-the-art POMDP solution methods to bear on problems defined through an interface that provides convenience and flexibility.


% first the preface sections.  

% this includes the file preface.tex which should include the
% following commands
% \beforepreface
% \prefacesection{preface}
% body of the preface
% \include{preface}

% any other preface sections

% the last preface section (e.g., acknowledgement.tex)
% should look like
\prefacesection{Acknowledgements}

The biggest debt of gratitude that I owe to any single person for this thesis is to my advisor, Mykel Kochenderfer.
In my opinion, the most admirable thing about Mykel is not the quality of work that he produces (though that is quite impressive), but his commitment and care for students as researchers and people.
I will always think of his office as one of my favorite places of learning on campus.
He took me on as a student during a time of struggling in my research and helped me finish strong.

I also owe a great deal to Marco Pavone, who was my advisor for the first half of this endeavor.
Additionally, my thanks goes out to Dan DeBra, who brought me here to Stanford, and Suman Chakravorty and Jon Rogers who were instrumental in my early growth as a researcher at Texas A\&M.
I am also thankful to the other members of my defense committee: Mac Schwager, Chris Gerdes, and Dorsa Sadigh.

A PhD is not a disembodied pursuit of knowledge, but a journey undertaken by a human with a heart and soul and flaws and weaknesses.
As such, I must thank my community here at Stanford for their care of me as a human exploring God's creation.
Grace Presbyterian church provided a place of connection and growth for me, and my friends gave me constant support.
In particular, two friends, Jeff Reid and Daniel Galbraith, should be noted for their faithfulness over the entire time I was here.
Moreover, I certainly would not be here without my parents and sister and the rest of my family and friends who have been shaping me for my entire life.

I was fortunate to be a part of two outstanding labs during my time here, the Autonomous Systems Lab and the Stanford Intelligence Systems Lab, both of which gave me comraderie and sharpened my technical skills.
I'll remember both the hard work and fun that I had in these places.

The work in this thesis would not have been possible without the generous financial support that I received from a variety of sources including MIT Lincoln Laboratory, the National Science Foundation, the U.S.\ Naval Research Laboratory, and Toyota Resarch Institute.
I must also recognize the leadership and staff of Stanford University and the Aeronautics and Astronautics department.
They have created a remarkable environment for learning.

% body 
% \include{acknowledgement}

\afterpreface


% now for the body of the thesis, modify the number of these lines as needed

% this includes chapter1.tex which should start with a \chapter{...}
% command 
\include{intro}
\include{uav}
\include{multilane}
\include{pomcpow}
\include{pomdpsjl}
\include{summary}

% and the end material

\appendix
% 
\include{proof}
% \include{appendix2}
% \include{appendix3}


% bibliography.tex should include either 
% \bibliographystyle{...}
% \bibliography{mythesis}
% or some other way of doing the bibliography
% \include{bibliography}

\printbibliography

\end{document}
